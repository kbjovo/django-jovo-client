{% load static tailwind_tags %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Jovo{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    {% tailwind_css %}

    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js" 
        integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz" crossorigin="anonymous"></script>
    
    <!-- Dark Mode Script (must be in head to prevent flash) -->
    <script>
        // Check for saved theme preference or default to light mode
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }
    </script>
    
    <style>
        [x-cloak] { display: none !important; }
    </style>

    <!-- For Toast -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
    

    {% block extra_css %}{% endblock %}

</head>

<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-200">
    
    
    <div x-data="{ sidebarOpen: false }" @keydown.escape="sidebarOpen = false" class="flex h-screen overflow-hidden">
        
        <!-- Mobile Menu Button (visible on mobile/tablet only) -->
        <button 
            @click="sidebarOpen = !sidebarOpen"
            class="lg:hidden fixed top-4 left-4 z-50 p-2 rounded-lg bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 shadow-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition">
            <svg x-show="!sidebarOpen" class="w-6 h-6 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
            <svg x-show="sidebarOpen" x-cloak class="w-6 h-6 text-gray-700 dark:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>

        <!-- Overlay for mobile/tablet (when sidebar is open) -->
        <div 
            x-show="sidebarOpen" 
            @click="sidebarOpen = false"
            x-transition:enter="transition-opacity ease-linear duration-300"
            x-transition:enter-start="opacity-0"
            x-transition:enter-end="opacity-100"
            x-transition:leave="transition-opacity ease-linear duration-300"
            x-transition:leave-start="opacity-100"
            x-transition:leave-end="opacity-0"
            class="fixed inset-0 bg-gray-900 bg-opacity-50 z-30 lg:hidden"
            x-cloak>
        </div>

        <!-- Sidebar -->
        <aside 
            x-bind:class="{
                'translate-x-0': sidebarOpen,
                '-translate-x-full lg:translate-x-0': !sidebarOpen
            }"
            class="fixed lg:static inset-y-0 left-0 z-40 transition-transform duration-300 ease-in-out">
            <c-sidebar />
        </aside>

        <!-- Main Content -->
        <main 
            id="main-content" 
            x-bind:class="{
                'ml-0': true
            }"
            class="flex-1 overflow-y-auto transition-all duration-300 ease-in-out">
            <div class="p-6 pt-20 lg:pt-6">
                <div class="max-w-7xl mx-auto">
                    {% block content %}
                    <!-- Your page content goes here -->
                    {% endblock %}
                </div>
            </div>
        </main>

    </div>
    
    <!-- Scripts at the end of body -->
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script>
        // Dark mode toggle function
        window.toggleDarkMode = function() {
            document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
        }

        // Alpine store for sidebar state
        document.addEventListener('alpine:init', () => {
            Alpine.store('sidebar', {
                collapsed: localStorage.getItem('sidebarCollapsed') === 'true',
                toggle() {
                    this.collapsed = !this.collapsed;
                    localStorage.setItem('sidebarCollapsed', this.collapsed);
                }
            });
        });
    </script>

    {% block extra_js %}{% endblock %}

    <script>
        document.body.addEventListener('htmx:configRequest', (event) => {
            const token = document.querySelector('[name=csrfmiddlewaretoken]')?.value;
            if (token) event.detail.headers['X-CSRFToken'] = token;
        });
    </script>

    
   {% include '_toast.html' %}


</body>

</html>