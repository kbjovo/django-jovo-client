# ============================================
# Docker Environment Configuration
# ============================================
# Copy this file to .env.docker.local and customize for your environment
# This file is used by docker-compose.yaml

# ============================================
# Django Configuration
# ============================================
DEBUG=True
SECRET_KEY=your-secret-key-change-in-production
ALLOWED_HOSTS=localhost,127.0.0.1,django

# ============================================
# Database Configuration (Docker MySQL)
# ============================================
DB_ENGINE=django.db.backends.mysql
DB_NAME=client
DB_USER=root
DB_PASSWORD=root
DB_HOST=mysql
DB_PORT=3306

# ============================================
# Redis Configuration (Docker Redis)
# ============================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
CELERY_BROKER_URL=redis://redis:6379/0
CELERY_RESULT_BACKEND=redis://redis:6379/0

# ============================================
# Kafka Configuration (Docker Kafka)
# ============================================
KAFKA_BOOTSTRAP_SERVERS=kafka-1:29092,kafka-2:29092,kafka-3:29092
KAFKA_CONNECT_URL=http://kafka-connect:8083
JOLOKIA_URL=http://kafka-connect:8778/jolokia
SCHEMA_REGISTRY_URL=http://schema-registry:8081

# ============================================
# NPM Configuration
# ============================================
NPM_BIN_PATH=/usr/bin/npm

# ============================================
# Kafka Topic Configuration
# ============================================
# Number of partitions per topic
# Keep at 1 for now, increase for high-volume tables if needed
KAFKA_TOPIC_PARTITIONS=1

# Replication factor (must be <= number of brokers)
# With 3 brokers, RF=3 ensures data survives broker failures
KAFKA_TOPIC_REPLICATION_FACTOR=3

# Minimum in-sync replicas for writes to succeed
# With RF=3, MIN_ISR=2 allows 1 broker to fail without blocking writes
KAFKA_TOPIC_MIN_ISR=2

# Retention time in milliseconds (default: 604800000 = 7 days)
KAFKA_TOPIC_RETENTION_MS=604800000

# Retention size in bytes per partition (default: -1 = unlimited)
KAFKA_TOPIC_RETENTION_BYTES=-1

# Cleanup policy (delete or compact)
KAFKA_TOPIC_CLEANUP_POLICY=delete

# Compression type (snappy recommended for CDC)
KAFKA_TOPIC_COMPRESSION_TYPE=snappy

# ============================================
# Kafka Connect Configuration
# ============================================
# JVM Heap size for Kafka Connect
# Recommended: 2GB for 1-3 connectors, 4GB for 4-10, 6-8GB for 10-20
KAFKA_CONNECT_HEAP_OPTS=-Xms4G -Xmx4G

# ============================================
# Sink Connector Error Handling (Dead Letter Queue)
# ============================================
# Error tolerance: "none" = fail on error, "all" = continue and send to DLQ
SINK_ERRORS_TOLERANCE=all

# Enable Dead Letter Queue for failed records
SINK_DLQ_ENABLED=true

# DLQ topic replication factor (should match KAFKA_TOPIC_REPLICATION_FACTOR)
SINK_DLQ_REPLICATION_FACTOR=3

# Include error context headers in DLQ messages (helps debugging)
SINK_DLQ_CONTEXT_HEADERS=true

CLUSTER_ID=MkU3OEVBNTcwNTJENDM2Qk
